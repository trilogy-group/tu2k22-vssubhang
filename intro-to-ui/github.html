<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <script>
        function githubApiCall(){
            const querystring = window.location.search.substring(1);
        const queryparams = new URLSearchParams(querystring);
        var pair;
        for (pair of queryparams.entries() ){
            console.log("key and value are- ", pair[0], pair[1] );
        }

        var myHeaders = new Headers();
        myHeaders.append("Content-Type", "application/json");
        var raw = JSON.stringify({
            "code": pair[1],
        });
        
        var requestOptions = {
            method: 'POST',
            headers: myHeaders,
            body: raw,
            redirect: 'follow'
            };
        console.log("inside")
        fetch("https://8000-lime-capybara-6omy6a7p.ws.trilogy.devspaces.com/api/v1/github-login/", requestOptions)
            .then(response => response.text())
            .then(result => console.log(result))
            .then(function (data) {
                        let result = `<h2> You have been lokecked in </h2>`;
                            document.getElementById('loader').innerHTML = result;
        })  
        }               
    </script>
</head>
<body onload="githubApiCall()">

    <p id="loader">Loading</p>
</body>
    